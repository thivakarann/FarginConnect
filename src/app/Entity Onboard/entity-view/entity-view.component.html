<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>



<div class="tab-container mt-5">
    <div class="tabs mb-3">
        <button class="tab" [class.active]="activeTab === 'events'" (click)="selectTab('events')">Personal
            Information</button>
        <button class="tab" [class.active]="activeTab === 'materials'" (click)="selectTab('materials')">Bank
            Details</button>
        <button class="tab" [class.active]="activeTab === 'videos'" (click)="selectTab('videos')">Kyc Documents</button>
        <button class="tab" [class.active]="activeTab === 'doot'" (click)="selectTab('doot')">Bank & Kyc
            Approval</button>
        <button class="tab" [class.active]="activeTab === 'doot1'" (click)="selectTab('doot1')">Final Approval</button>

    </div>
    <div class="tab-content" *ngIf="activeTab === 'events'">

        <div class="filters">
            <div class="col-12">
                <!-- <article class="card car-details label-info"> -->
                <!-- <div class="card-body"> -->
                <div class="d-flex flex-md-row align-items-md-start align-items-center flex-column">
                    <div class="w-100">
                        <div class="d-flex flex-md-row flex-column">
                            <h5 class="mr-3">Personal Information</h5>
                        </div>
                        <hr>

                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-6 col-12">
                                    <div class="d-flex flex-column">
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">
                                                Refference Number</div>
                                            <div class="w-50">{{detaislone?.referenceNo}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">
                                                Entity Name</div>
                                            <div class="w-50">{{detaislone?.entityName}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Merchant Legal Name
                                            </div>
                                            <div class="w-50">{{detaislone?.merchantLegalName}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Account DisplayName</div>
                                            <div class="w-50">{{detaislone?.accountDisplayName}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Bussiness category</div>
                                            <div class="w-50">{{detaislone?.businessCategoryModel?.categoryName}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">MCC Code</div>
                                            <div class="w-50">{{detaislone?.mccCode}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Billing Address</div>
                                            <div class="w-50">{{detaislone?.billingAddress}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Area</div>
                                            <div class="w-50">{{detaislone?.area}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">City</div>
                                            <div class="w-50">{{detaislone?.city}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Pincode</div>
                                            <div class="w-50">{{detaislone?.zipcode}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12">
                                    <div class="d-flex flex-column">
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Contact Name</div>
                                            <div class="w-50">{{detaislone?.contactName}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Contact Email</div>
                                            <div class="w-50">{{detaislone?.contactEmail}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Primary Mobile Number
                                            </div>
                                            <div class="w-50">{{detaislone?.contactMobile}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Secondary Mobile Number</div>
                                            <div class="w-50">{{detaislone?.secondaryMobile}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Website</div>
                                            <div class="w-50">{{detaislone?.website}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Location Served</div>
                                            <div class="w-50">{{detaislone?.locationServed}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Service Offered</div>
                                            <div class="w-50">{{detaislone?.serviceOffered}}</div>
                                        </div>

                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">Country</div>
                                            <div class="w-50">{{detaislone?.country}}</div>
                                        </div>
                                        <div class="d-flex mb-2">
                                            <div class="w-50 font-weight-bold">State</div>
                                            <div class="w-50">{{detaislone?.stateName}}</div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <!-- </div> -->
                <!-- </article> -->




            </div>
            <button class="btn clear" (click)="clearFilters()"></button>
        </div>
    </div>
    <div class="tab-content" *ngIf="activeTab === 'materials'">
        <div class="row">
            <div class="col-10">
                <h4>Bank Details</h4>
            </div>
            <div class="col-2">
                <button class="approvalButton" (click)="addbank(this.id)">ADD
                    Bank</button>
            </div>
        </div>
        <div class="container mt-4">
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead style="background-color: aqua;">
                        <tr>
                            <th>S No </th>
                            <th>Beneficiary Name</th>
                            <th>Account Number</th>
                            <th>Account Type</th>
                            <th>IFSC Code</th>
                            <th>Bank Name</th>
                            <th>Branch Name</th>
                            <th>Approval Status</th>
                            <th>Bank Status</th>
                            <th>Primary Status</th>
                            <th>Approval</th>
                            <th>Approvet At</th>
                            <th>Comments</th>
                            <th>Action</th>
                            <th>Verification</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of bankdetails,let i=index">
                            <td>{{i+1}}</td>
                            <td>{{item.accountHolderName}}</td>
                            <td>{{item.accountNumber}}</td>
                            <td>{{item.accountType}}</td>
                            <td>{{item.ifscCode}}</td>
                            <td>{{item.bankName}}</td>
                            <td>{{item.branchName}}</td>
                            <td [ngClass]="{
                                    yellow: item?.approvalStatus === 'Pending',
                                    green: item?.approvalStatus === 'approved',
           
                                    Red: item?.approvalStatus == 'Rejected'
                                  }">{{item.approvalStatus}}</td>
                            <td>
                                <mat-slide-toggle class="example-margin" color="primary"
                                    [checked]="item.activeStatus==1" (change)="bankStatus($event,item.merchantBankId)">
                                </mat-slide-toggle>
                            </td>
                            <td>
                                <mat-slide-toggle class="example-margin" color="primary"
                                    [checked]="item.primaryAccountStatus==1"
                                    (change)="onSubmit($event,item.merchantBankId)">
                                </mat-slide-toggle>
                            </td>
                            <td><button class="approvalButton"
                                    (click)="BankApproval(item.merchantBankId)">Approval</button>
                            </td>
                            <td>{{item.approvalDateTime|date:"dd/MM/yyyy hh:mm:a"}}</td>
                            <td style="text-align: center;font-size: 20px;cursor: pointer;"><span
                                    (click)="BankComments(item.reMarks)"><i class="fas fa-comments"></i></span></td>

                            <td class="text-center"><i style="cursor: pointer;font-size: 17px;" (click)="editbank(item)"
                                    class="fa fa-edit"></i></td>
                            <td class="text-center">
                                <p class="form-label"> <i style="overflow:hidden" [matMenuTriggerFor]="menu"
                                        class="fa fa-ellipsis-v">
                                        <mat-menu #menu="matMenu">
                                            <button style="font-size: 10px;" mat-menu-item
                                                (click)="bankInfo(item.bavId)">Info</button>
                                            <button style="font-size: 10px;" mat-menu-item
                                                [disabled]="item.facheckStatus==1"
                                                (click)="bankVerification(item.merchantBankId)">Verify</button>
                                            <button style="font-size: 10px;" mat-menu-item
                                                [disabled]="item.facheckStatus==0  || item.facheckStatus==2"
                                                (click)="bankVerification(item.merchantBankId)">
                                                Re-Verify </button>
                                        </mat-menu>
                                    </i>
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <button class="btn clear" (click)="clearFilters()"></button>
    </div>
    <div class="tab-content" *ngIf="activeTab === 'videos'">
        <div class="row">
            <div class="col-10">
                <h4>KYC Documents</h4>
            </div>
            <div class="col-2">
                <button class="approvalButton" (click)="addKycdocuments(this.id,this.businessCategoryId)">ADD
                    KYC</button>
            </div>
        </div>
        <div class="container mt-3">
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead style="background-color: aqua;">
                        <tr>
                            <th>S No </th>
                            <th>KYC Name</th>
                            <th>KYC Number</th>
                            <th>KYC Front Path</th>
                            <th>KYC Back Path</th>
                            <th>Approval Status</th>
                            <th>Approval</th>
                            <th>Approved By</th>
                            <th>Approval At</th>
                            <th>Comments</th>
                            <th>Action</th>
                            <th>Verification Status</th>
                            <th>Verfication </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of KYCDetails,let i=index">
                            <td>{{i+1}}</td>
                            <td>{{item.docName}}</td>
                            <td>{{item.docNumber}}</td>
                            <td class="text-center"><i class='fas fa-file-alt'
                                    style='font-size:15px;cursor: pointer;color:#545497;'
                                    (click)="getFrontPath(item.merchantDocumentId)"></i></td>
                            <td class="text-center"><i class='fas fa-file-alt'
                                    style='font-size:15px;cursor: pointer;color:#545497;'
                                    (click)="getBackPath(item.merchantDocumentId)"></i></td>
                            <td [ngClass]="{
                                        yellow: item?.approvalStatus === 'Pending',
                                        green: item?.approvalStatus === 'approved',
               
                                        Red: item?.approvalStatus == 'Rejected'
                                      }">{{item.approvalStatus}}</td>
                            <td><button class="approvalButton"
                                    (click)="KycApproval(item.merchantDocumentId)">Approval</button>
                            <td>
                                {{item.approvalBy}}
                            </td>
                            <td>{{item.approvalDateTime}}</td>
                            <td style="text-align: center;font-size:15px;cursor: pointer;color:#545497;"><span
                                    (click)="KYCComments(item.reMarks)"><i class="fas fa-comments"></i></span></td>
                            <td class="text-center"
                                style="text-align: center;font-size:15px;cursor: pointer;color:#545497;"
                                (click)="editKycDocuments(item.merchantDocumentId)"><i class="fas fa-edit"></i></td>
                            <td class="text-center">
                                <span *ngIf="item.facheckStatus == 1"
                                    style="font-size:14px;color:green;">Verified</span>
                                <span *ngIf="item.facheckStatus == 0" style="font-size:14px;color:red;">
                                    Not-Verified</span>
                            </td>
                            <td class="text-center">
                                <p class="form-label"> <i style="overflow:hidden" [matMenuTriggerFor]="menu"
                                        class="fa fa-ellipsis-v">
                                        <mat-menu #menu="matMenu">
                                            <button style="font-size: 10px;" mat-menu-item>Info</button>
                                            <button style="font-size: 10px;" mat-menu-item [disabled]="item.kycId==1"
                                                (click)="FacheckVerification(item.docName,item.docNumber,item.merchantDocumentId,item.approvalBy)">Verify</button>

                                            <button style="font-size: 10px;" mat-menu-item [disabled]="item.kycId==0"
                                                (click)="FacheckVerification(item.docName,item.docNumber,item.kycId,item.approvalBy)">
                                                Re-Verify </button>
                                        </mat-menu>
                                    </i>

                                </p>
                            </td>
                        </tr>
                        <!-- Add more rows as needed -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="tab-content" *ngIf="activeTab === 'doot'">
        <div class="row ">
            <div class="col-10">
                <h4>3rd Level Approval</h4>
            </div>
            <div class="col-2">
                <!-- <button class="approvalButton" (click)="addKycdocuments(this.id,this.businessCategoryId)">ADD KYC</button> -->
            </div>
        </div>
        <div class="container mt-2">
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead style="background-color: aqua;">
                        <tr>
                            <th>S No </th>
                            <th>Bank & KYC Approval Status</th>
                            <th>Approved By</th>
                            <th>Approval At</th>
                            <th>Approval</th>
                            <th>Comments</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>{{this.detaislone?.approvalStatusL1}}</td>
                            <td>{{this.detaislone?.approvedByL1}}</td>
                            <td>{{this.detaislone?.approvedDateTimeL1}}</td>
                            <td><button class="approvalButton" (click)="levelOneApproval(this.id)">Approval 1</button>
                            <td style="text-align: center;font-size:15px;cursor: pointer;color:#545497;"><span
                                    (click)="leveloneComments(this.detaislone?.comment)"><i
                                        class="fas fa-comments"></i></span></td>
                        </tr>
                        <!-- Add more rows as needed -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="tab-content" *ngIf="activeTab === 'doot1'">
        <div class="row">
            <div class="col-10">
                <h4>Final Approval</h4>
            </div>
            <div class="col-2">
                <!-- <button class="approvalButton" (click)="addKycdocuments(this.id,this.businessCategoryId)">ADD KYC</button> -->
            </div>
        </div>
        <div class="container mt-2">
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead style="background-color: aqua;">
                        <tr>
                            <th>S No </th>
                            <th>Overall Approval Status</th>
                            <th>Approved By</th>
                            <th>Approval At</th>
                            <th>Approval</th>
                            <th>Comments</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>{{this.detaislone?.approvalStatusL2}}</td>
                            <td> {{this.detaislone?.approvedByL2}}</td>
                            <td>{{this.detaislone?.approvedDateTimeL2}}</td>
                            <td><button class="approvalButton" (click)="levelTwoApproval(this.id)">Approval 1</button>
                            <td style="text-align: center;font-size:15px;cursor: pointer;color:#545497;"><span
                                    (click)="levelTwoComments(this.detaislone?.commentL2)"><i
                                        class="fas fa-comments"></i></span></td>
                        </tr>
                        <!-- Add more rows as needed -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<!-- Bootstrap JS and dependencies -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>