<div class="card-header">
  <h3 class="mb-0" style="font-weight: 700; text-align: center; font-size: 21px">
    Create New Export Data
  </h3>
</div>

<body class="page">
  <main class="main page__main">
    <form class="form main__form" autocomplete="off" class="form" role="form" [formGroup]="myForm">
      <div class="mb-3">
        <div class="form-group">
          <label for="critical">Report Title</label>
          <select (change)="exportpay($event)" class="form-select" formControlName="exportDataName" required>
            <option value="" selected hidden>Select an Option</option>
            <option value="12">Entity Onboard</option>
            <option value="22">Customer</option>
            <option value="15">SMS History</option>
            <option value="26">WhatsApp History</option>
            <option value="4">Customer Payments</option>
            <option value="13">Cloud Fee Payments</option>
            <option value="14">One Time Payments</option>
            <option value="19">Customized Payments</option>
            <option value="7">Additional Transactions</option>
            <option value="21">Cloud Fee AutoDebit</option>
            <option value="24">Renewal Fee AutoDebit</option>
            <option value="6">Static QR Transactions</option>
            <option value="23">Branch</option>
            <option value="20">Online Refund</option>
            <option value="16">Entity Request</option>
            <option value="17">Customer Request</option>
            <option value="18">Channel Creation</option>
          </select>
          <div style="
              color: red;
              font-size: 12px;
              margin-top: 2px;
              position: relative;
            " *ngIf="exportDataName?.invalid && exportDataName?.touched && exportDataName?.errors?.['required']">
            Field is required
          </div>
        </div>

        <div [hidden]="
            exportDataName?.value != '4' &&
            exportDataName?.value != '7' &&
            exportDataName?.value != '13' &&
            exportDataName?.value != '14' &&
            exportDataName?.value != '19' &&
            exportDataName?.value != '15' &&
            exportDataName?.value != '26' &&
            exportDataName?.value != '16' &&
            exportDataName?.value != '17' &&
            exportDataName?.value != '20' &&
            exportDataName?.value != '21' &&
            exportDataName?.value != '24' &&
            exportDataName?.value != '22'
          " class="form-group">
          <label for="website">Search Entity Legal Name here (Optional)</label>
          <div class="input-group">
            <input type="text" class="form-control custom-input" formControlName="selectedOption"
              [(ngModel)]="customerInput" placeholder="Search Entity Name" (input)="onInputChange()"
              (focus)="showSuggestions = true" (blur)="hideSuggestions()" />
            <!-- Dropdown List -->
            <ul class="suggestion-box" *ngIf="showSuggestions && options.length > 0">
              <li *ngFor="let item of options" (mousedown)="onSearchClick(item.merchantLegalName, $event)">
                {{ item.merchantLegalName }}
              </li>
            </ul>
          </div>
          <div *ngIf="isNoDataFound" style="color: red; font-size: 12px; margin-top: 2px">
            Entity Name not Found
          </div>
          <div *ngIf="errorShow" style="color: red; font-size: 12px; margin-top: 2px">
            Data not available
          </div>
        </div>

        <div [hidden]="
            exportDataName?.value != '6' && exportDataName?.value != '23'
          " class="form-group">
          <label for="website">Search Entity</label>
          <div class="input-group">
            <input [required]="
                exportDataName?.value == '6' && exportDataName?.value == '23'
              " type="text" class="form-control custom-input" formControlName="staticoption"
              [(ngModel)]="customerInput" placeholder="Search Entity Name" (input)="onInputChange()"
              (focus)="showSuggestions = true" (blur)="hideSuggestions()" />
            <ul class="suggestion-box" *ngIf="showSuggestions && options.length > 0">
              <li *ngFor="let item of options" (mousedown)="onSearchClick(item.merchantLegalName, $event)">
                {{ item.merchantLegalName }}
              </li>
            </ul>
          </div>
          <div *ngIf="isNoDataFound" style="color: red; font-size: 12px; margin-top: 2px">
            Entity Name not Found
          </div>
          <div *ngIf="errorShow" style="color: red; font-size: 12px; margin-top: 2px">
            Data not available
          </div>
          <div *ngIf="staticoption?.invalid && staticoption?.touched"
            style="color: red; font-size: 12px; margin-top: 2px">
            Field is required
          </div>
        </div>

        <!-- Branch  -->
        <div [hidden]="exportDataName?.value != '23'" class="form-group">
          <label for="website">Branch Name</label>
          <!-- <input type="text" id="website" class="form-control" formControlName="branchId"> -->
          <select [required]="exportDataName?.value == '23'" (change)="onBranchChange($event)"
            formControlName="branchId" id="branchId" class="form-select">
            <option value="" disabled selected>Select</option>
            <option *ngFor="let item of branchviews" [value]="item.branchId">
              {{ item.branchName }}
            </option>
            <option *ngIf="branchviews.length === 0" disabled>
              No item found
            </option>
          </select>
          <div style="
              color: red;
              font-size: 12px;
              margin-top: 2px;
              position: relative;
            " *ngIf="branchId?.invalid && branchId?.touched && branchId?.errors?.['required']">
            Field is required
          </div>
        </div>

        <div [hidden]="exportDataName?.value != '6'" class="form__linput">
          <label for="paymentStatusStactic">Payment Status (Optional)</label>
          <select formControlName="paymentStatusStactic" type="text" id="fname" class="form-select">
            <option value="SUCCESS">Success</option>
            <option value="FAILURE">Failure</option>
          </select>
        </div>



        <div [hidden]="exportDataName?.value != '20' && exportDataName?.value != '23' " class="form__linput">
          <label [hidden]="exportDataName?.value != '20'" for="paymentrefundmethod">
            Refund Payment Type
          </label>
          <label [hidden]="exportDataName?.value != '23'" for="paymentrefundmethod">
            Branch Payment Type
          </label>
          <select [required]="exportDataName?.value == '20'" formControlName="paymentrefundmethod" type="text"
            id="paymentrefundmethod" class="form-select">
            <option value="1">Due Payment</option>
            <option value="2">Additional Payment</option>
          </select>
          <div style="
              color: red;
              font-size: 12px;
              margin-top: 2px;
              position: relative; ;
            "
            *ngIf="paymentrefundmethod?.invalid && paymentrefundmethod?.touched && paymentrefundmethod?.errors?.['required']">
            Field is required
          </div>
        </div>

        <div [hidden]="
            exportDataName?.value != '4' &&
            exportDataName?.value != '7' &&
            exportDataName?.value != '13' &&
            exportDataName?.value != '14' &&
            exportDataName?.value != '19' &&
            exportDataName?.value != '23'
          " class="form__linput">
          <label for="paymentStatus">Payment Status (Optional)</label>
          <select formControlName="paymentStatus" type="text" id="fname" class="form-select">
            <option value="Success">Success</option>
            <option value="Failure">Failure</option>
            <option value="Initiated">Initiated</option>
            <option value="Due Pending">Due Pending</option>
            <option value="Due Cancelled">Due Cancelled</option>
            <option value="Payment Incomplete">Payment Incomplete</option>
          </select>
        </div>

        <div class="form-group">
          <label for="exportStartDate">Export From Date</label>
          <input onkeydown="return false;" (change)="future(this.myForm.get('exportEndDate')?.value)" [max]="maxDate"
            type="date" id="exportStartDate" formControlName="exportStartDate" class="form-control" />
          <div style="
              color: red;
              font-size: 12px;
              margin-top: 2px;
              position: relative;
            " *ngIf="exportStartDate?.invalid && exportStartDate?.touched && exportStartDate?.errors?.['required']">
            Field is required
          </div>
        </div>

        <div class="form-group">
          <label for="exportEndDate">Export To Date</label>
          <input onkeydown="return false;" [min]="this.myForm.get('exportStartDate')?.value" [max]="maxDate" type="date"
            id="exportEndDate" formControlName="exportEndDate" class="form-control" />
          <div style="
              color: red;
              font-size: 12px;
              margin-top: 2px;
              position: relative;
            " *ngIf="exportEndDate?.invalid && exportEndDate?.touched && exportEndDate?.errors?.['required']">
            Field is required
          </div>
        </div>
      </div>

      <div>
        <button (click)="submitForm()" [disabled]="myForm.invalid" type="submit" class="btn mx-1"
          style="background-color: #7db855be">
          Submit
        </button>
        <button type="submit" class="btn" style="background-color: #141e46; color: white" matDialogClose>
          Cancel
        </button>
      </div>
    </form>
  </main>
</body>